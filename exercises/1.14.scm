; 1.14

(count-change 11)

; 木構造を書く準備 
; (+ (cc 11 4) (cc -39 5))
; (+ (+ (cc 11 3) (cc -14 4)) 0)
; (+ (+ (+ (cc 11 2) (cc 1 3)) 0) 0)
; (+ (+ (+ (+ (cc 11 1) (cc 6 2)) (+ (cc 1 2) (cc -9 3))) 0) 0)
; (+ (+ (+ (+ (+ (cc 11 0) (cc 10 1)) (+ (cc 6 1) (cc 1 2))) (+ (+ (cc 1 1) (cc -4 2)) 0)) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ (cc 10 0) (cc 9 1))) (+ (+ (cc 6 0) (cc 5 1)) (+ (cc 1 1) (cc -4 2)))) (+ (+ (+ (cc 1 0) (cc 0 1)) 0) 0)) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ (cc 9 0) (cc 8 1)))) (+ (+ 0 (+ (cc 5 0) (cc 4 1))) (+ (+ (cc 1 0) (cc 0 1)) 0))) (+ (+ (+ 0 1) 0) 0)) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 (+ (cc 8 0) (cc 7 1))))) (+ (+ 0 (+ 0 (+ (cc 4 0) (cc 3 1)))) (+ (+ 0 1) 0))) (+ (+ 1 0) 0)) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ (cc 7 0) (cc 6 1)))))) (+ (+ 0 (+ 0 (+ 0 (+ (cc 3 0) (cc 2 1))))) (+ 1 0))) (+ 1 0)) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ (cc 6 0) (cc 5 1))))))) (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ (cc 2 0) (cc 1 1)))))) 1)) 1) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ (cc 5 0) (cc 4 1)))))))) (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ (cc 1 0) (cc 0 1))))))) 1)) 1) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ (cc 4 0) (cc 3 1))))))))) (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 1)))))) 1)) 1) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ (cc 3 0) (cc 2 1)))))))))) (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 1))))) 1)) 1) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ (cc 2 0) (cc 1 1))))))))))) (+ (+ 0 (+ 0 (+ 0 (+ 0 1)))) 1)) 1) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ (cc 1 0) (cc 0 1)))))))))))) (+ (+ 0 (+ 0 (+ 0 1))) 1)) 1) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 1))))))))))) (+ (+ 0 (+ 0 1)) 1)) 1) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 1)))))))))) (+ (+ 0 1) 1)) 1) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 1))))))))) (+ 1 1)) 1) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 1)))))))) 2) 1) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 1))))))) 2) 1) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 1)))))) 2) 1) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 (+ 0 (+ 0 1))))) 2) 1) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 (+ 0 1)))) 2) 1) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 (+ 0 1))) 2) 1) 0) 0)
; (+ (+ (+ (+ (+ 0 (+ 0 1)) 2) 1) 0) 0)
; (+ (+ (+ (+ (+ 0 1) 2) 1) 0) 0)
; (+ (+ (+ (+ 1 2) 1) 0) 0)
; (+ (+ (+ 3 1) 0) 0)
; (+ (+ 4 0) 0)
; (+ 4 0)
; 4

; 木構造
; (count-change 11)
;       ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
;   (cc 11 4)                                                                                                                                                         (cc -39 5)
;       ├───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐          │
;   (cc 11 3)                                                                                                                                              (cc -14 4)      0
;       ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                      │
;   (cc 11 2)                                                                                                        (cc 1 3)                                   0
;       ├───────────────────────────────────────────┐                                                                    ├───────────────────────────┐
;   (cc 11 1)                                   (cc 6 2)                                                             (cc 1 2)                    (cc -9 3)
;       ├─────────┐                                 ├───────────────────────────────────────┐                            ├─────────────────┐         │
;   (cc 11 0) (cc 10 1)                         (cc 6 1)                                (cc 1 2)                     (cc 1 1)          (cc -4 2)     0
;       │         ├─────────┐                       ├────────┐                              ├─────────────────┐          ├────────┐        │
;       0     (cc 11 0) (cc 10 1)               (cc 6 0) (cc 5 1)                       (cc 1 1)          (cc -4 2)  (cc 1 0) (cc 0 1)     0
;                 │         ├─────────┐             │        ├────────┐                     ├────────┐        │          │        │
;                 0     (cc 10 0) (cc 9 1)          0    (cc 5 0) (cc 4 1)              (cc 1 0) (cc 0 1)     0          0        1
;                           │         ├────────┐             │        ├────────┐            │        │
;                           0     (cc 9 0) (cc 8 1)          0    (cc 4 0) (cc 3 1)         0        1
;                                     │        ├────────┐             │        ├────────┐
;                                     0    (cc 8 0) (cc 7 1)          0    (cc 3 0) (cc 2 1)
;                                              │        ├────────┐             │        ├────────┐
;                                              0    (cc 7 0) (cc 6 1)          0    (cc 2 0) (cc 1 1)
;                                                       │        ├────────┐             │        ├────────┐
;                                                       0    (cc 6 0) (cc 5 1)          0    (cc 1 0) (cc 0 1)
;                                                                │        ├────────┐             │        │
;                                                                0    (cc 5 0) (cc 4 1)          0        1
;                                                                         │        ├────────┐
;                                                                         0    (cc 4 0) (cc 3 1)
;                                                                                  │        ├────────┐
;                                                                                  0    (cc 3 0) (cc 2 1)
;                                                                                           │        ├────────┐
;                                                                                           0    (cc 2 0) (cc 1 1)
;                                                                                                    │        ├────────┐
;                                                                                                    0    (cc 1 0) (cc 0 1)
;                                                                                                             │        │
;                                                                                                             0        1
;

; プロセスが使うスペースの増加の程度
;
;  実際の処理系は「作用的順序の評価」を行うことに注意する。
;  例として、(cc 11 2) の評価を考える。
;  これは (+ (cc 11 1) (cc 6 2)) となるが、作用的順序では展開より先に引数を評価するのであったから、展開ではなく (cc 11 1) の評価が行われる。
;    (か、もしくは (cc 6 2) の評価が行われる。どちらが先に評価されるかはここでは本質的ではない。)
;  上の木構造を参考にして、例えばnセントの両替で、最終的には1セント硬貨のみを考えている場合にプロセスが使うスペースは大きくなっていくが、ここで必要なスペースはたかだか n である。
;  (cc 11 1) を 1 と評価した後に (cc 6 2) の評価が行われる。
;  従って、プロセスが使うスペースは Θ(n) で増加する。
;

; ステップ数の増加の程度
;
;  まず1セント硬貨のみを用いた場合のnセントの両替を考える。
;  この場合に必要な計算のステップ数は明らかに n に比例して、ステップ数の増加の程度は Θ(n)。
;
;  次に、1セント硬貨と5セント硬貨のみを用いた場合のnセントの両替を考える。(簡単の為に n は 5 で割り切れるものとします。)
;  整数 m を m := n/5 とおく。
;  この時、5セント硬貨を0枚以上使う場合の残りの金額は、n, n-5, n-5*2, …, n-5*m となる。(ここで m+1 通りの残りの金額が発生する。)
;  残りの金額は1セント硬貨のみで両替を行う。
;  1セント硬貨のみを用いた両替でのステップ数の増加の程度は Θ(n)。これが m+1 = n/5+1 通り存在し、Θ(n)*(n/5+1) -> Θ(n^2) となる。
;  5セント硬貨を考えている時には、残額は1セント硬貨の5倍の速さで無くなっていく。
;  よってステップ数の増加の程度は上で述べた Θ(n^2) が支配的である。
;
;  (より詳細に書くと、kinds-of-coins=2 で約 (n/5)*(n/5)/2 回の足し算が必要になり、
;   kinds-of-coins=1 で約 n*(n/5)/2 回の足し算が必要になる。(少し不安、あっていますか…?))
;
;  硬貨が増えた場合も同様の議論ができて、l種類の硬貨を考えている場合にはステップ数の増加の程度は Θ(n^l) である。
;  従って、ステップ数は Θ(n^5) で増加する。
;