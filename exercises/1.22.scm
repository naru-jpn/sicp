; 1.22

; 素数チェック用

(define (divides? a b)
  (= (remainder b a) 0))

(define (find-divisor n test-divisor)
  (cond ((> (square test-divisor) n) n)
        ((divides? test-divisor n) test-divisor)
        (else (find-divisor n (+ test-divisor 1)))))

(define (smallest-divisor n)
  (find-divisor n 2))

(define (prime? n)
  (= n (smallest-divisor n)))


; 目的のプログラム

(define (timed-prime-test n)
  (newline)
  (display n)
  (start-prime-test n (runtime)))

(define (start-prime-test n start-time)
  (if (prime? n)
      (report-prime (- (runtime) start-time))))

(define (report-prime elapsed-time)
  (display " *** ")
  (display elapsed-time))

(define (search-for-primes n max)
  (cond ((even? n) (search-for-primes (+ n 1) max))
        ((> n max) "finish")
        (else
          (timed-prime-test n)
          (search-for-primes (+ n 2) max))))


;
; 1,000 より大きい、小さい方から3つまでの素数
(search-for-primes 1000 1050)
; 1001
; 1003
; 1005
; 1007
; 1009 *** 0.
; 1011
; 1013 *** 0.
; 1015
; 1017
; 1019 *** 0.
; ...略
;
;  答. {1009, 1013, 1019}

;
; 10,000 より大きい、小さい方から3つまでの素数
(search-for-primes 10000 10050)
;
; 10001
; 10003
; 10005
; 10007 *** 0.
; 10009 *** 0.
; 10011
; 10013
; 10015
; 10017
; 10019
; 10021
; 10023
; 10025
; 10027
; 10029
; 10031
; 10033
; 10035
; 10037 *** 0.
; ...略
;
;  答. {10007, 10009, 10037}

;
; 100,000 より大きい、小さい方から3つまでの素数
(search-for-primes 100000 100050)
;
; 100001
; 100003 *** 9.999999999999995e-3
; 100005
; 100007
; 100009
; 100011
; 100013
; 100015
; 100017
; 100019 *** 0.
; 100021
; 100023
; 100025
; 100027
; 100029
; 100031
; 100033
; 100035
; 100037
; 100039
; 100041
; 100043 *** 0.
; ...略
; 
;  答. {100003, 100019, 100043}

;
; 1,000,000 より大きい、小さい方から3つまでの素数
(search-for-primes 1000000 1000050)
; 1000001
; 1000003 *** 1.0000000000000009e-2
; 1000005
; 1000007
; 1000009
; 1000011
; 1000013
; 1000015
; 1000017
; 1000019
; 1000021
; 1000023
; 1000025
; 1000027
; 1000029
; 1000031
; 1000033 *** 0.
; 1000035
; 1000037 *** 9.999999999999995e-3
; ...略
; 
;  答. {1000003, 1000033, 1000037}


;
; 時間計測の課題だが、測定の精度が十分でないらしく、100,000 と 1,000,000 での比較が行えなかった為、100,000,000 と 1,000,000,000 で比較した。
;
; 100,000,000 から 100,000,050 までに存在する素数
;
(search-for-primes 100000000 100000050)
; 100000001
; 100000003
; 100000005
; 100000007 *** .01999999999999999
; 100000009
; 100000011
; 100000013
; 100000015
; 100000017
; 100000019
; 100000021
; 100000023
; 100000025
; 100000027
; 100000029
; 100000031
; 100000033
; 100000035
; 100000037 *** 2.0000000000000018e-2
; 100000039 *** 9.999999999999981e-3
; 100000041
; 100000043
; 100000045
; 100000047
; 100000049 *** 1.0000000000000009e-2
;
; 計測時間の平均をとると、(0.01+0.01+0.02+0.02)/4 = 0.015 である。
.
; 1,000,000,000 から 1,000,000,050 までに存在する素数
;
(search-for-primes 1000000000 1000000050)
; 1000000001
; 1000000003
; 1000000005
; 1000000007 *** .04999999999999999
; 1000000009 *** .05000000000000002
; 1000000011
; 1000000013
; 1000000015
; 1000000017
; 1000000019
; 1000000021 *** .03999999999999998
; 1000000023
; 1000000025
; 1000000027
; 1000000029
; 1000000031
; 1000000033 *** .03999999999999998
; 1000000035
; 1000000037
; 1000000039
; 1000000041
; 1000000043
; 1000000045
; 1000000047
; 1000000049
;
; 計測時間の平均をとると、(0.04+0.04+0.05+0.05)/4 = 0.045 である。
;
; √10 ~ 3.16 であり、0.015 * 3.16 = 0.0474 なので、精度は悪いながらも、ここでは確かに計算に必要なステップ数に比例して計算時間が長くなっている。

